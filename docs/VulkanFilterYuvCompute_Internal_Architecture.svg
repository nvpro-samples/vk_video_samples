<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 1100" width="1400" height="1100">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
    <marker id="arrow-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1565C0"/>
    </marker>
    <marker id="arrow-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2E7D32"/>
    </marker>
    <marker id="arrow-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#E65100"/>
    </marker>
    
    <linearGradient id="inputGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#66BB6A"/>
      <stop offset="100%" style="stop-color:#2E7D32"/>
    </linearGradient>
    <linearGradient id="outputGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FFA726"/>
      <stop offset="100%" style="stop-color:#E65100"/>
    </linearGradient>
    <linearGradient id="shaderGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#42A5F5"/>
      <stop offset="100%" style="stop-color:#1565C0"/>
    </linearGradient>
    
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="1400" height="1100" fill="#FAFAFA"/>
  
  <!-- Title -->
  <text x="700" y="45" font-family="Arial, sans-serif" font-size="28" font-weight="bold" text-anchor="middle" fill="#1A237E">
    VulkanFilterYuvCompute - Internal Architecture
  </text>
  <text x="700" y="70" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#666">
    Dynamic Multi-Input/Output Compute Shader Filter
  </text>
  
  <!-- ============ INPUT SIDE ============ -->
  <g transform="translate(30, 100)">
    <!-- Input container -->
    <rect x="0" y="0" width="280" height="480" rx="10" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="280" height="40" rx="10" fill="url(#inputGrad)"/>
    <rect x="0" y="30" width="280" height="10" fill="url(#inputGrad)"/>
    <text x="140" y="28" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="white">
      INPUTS (Dynamic Slots)
    </text>
    
    <!-- Input Slot 0 -->
    <g transform="translate(15, 55)">
      <rect x="0" y="0" width="250" height="130" rx="6" fill="white" stroke="#4CAF50" stroke-width="1.5"/>
      <rect x="0" y="0" width="250" height="25" rx="6" fill="#A5D6A7"/>
      <rect x="0" y="20" width="250" height="5" fill="#A5D6A7"/>
      <text x="125" y="17" font-family="monospace" font-size="12" text-anchor="middle" fill="#1B5E20" font-weight="bold">input[0]</text>
      
      <text x="10" y="42" font-family="Arial" font-size="10" fill="#333" font-weight="bold">Type Options:</text>
      <text x="20" y="56" font-family="monospace" font-size="9" fill="#666">• SampledImage (YCbCr sampler)</text>
      <text x="20" y="68" font-family="monospace" font-size="9" fill="#666">• StorageImage (compute read)</text>
      <text x="20" y="80" font-family="monospace" font-size="9" fill="#666">• StorageBuffer (linear data)</text>
      
      <text x="10" y="96" font-family="Arial" font-size="10" fill="#333" font-weight="bold">Formats:</text>
      <text x="20" y="110" font-family="monospace" font-size="9" fill="#666">RGBA8, NV12, P010, I420, YUV444...</text>
      <text x="10" y="125" font-family="Arial" font-size="9" fill="#888">Bindings: 0-3 (4 planes max)</text>
    </g>
    
    <!-- Input Slot 1 (optional) -->
    <g transform="translate(15, 195)">
      <rect x="0" y="0" width="250" height="90" rx="6" fill="white" stroke="#81C784" stroke-width="1.5" stroke-dasharray="5,3"/>
      <rect x="0" y="0" width="250" height="25" rx="6" fill="#C8E6C9"/>
      <rect x="0" y="20" width="250" height="5" fill="#C8E6C9"/>
      <text x="125" y="17" font-family="monospace" font-size="12" text-anchor="middle" fill="#2E7D32" font-weight="bold">input[1] (optional)</text>
      
      <text x="10" y="45" font-family="Arial" font-size="10" fill="#666">Secondary input for:</text>
      <text x="20" y="60" font-family="monospace" font-size="9" fill="#888">• Temporal filtering (prev frame)</text>
      <text x="20" y="72" font-family="monospace" font-size="9" fill="#888">• Reference frames</text>
      <text x="10" y="85" font-family="Arial" font-size="9" fill="#888">Bindings: 4-7</text>
    </g>
    
    <!-- Input Slot N -->
    <g transform="translate(15, 295)">
      <rect x="0" y="0" width="250" height="60" rx="6" fill="white" stroke="#81C784" stroke-width="1.5" stroke-dasharray="5,3"/>
      <text x="125" y="25" font-family="Arial" font-size="14" text-anchor="middle" fill="#666">...</text>
      <text x="125" y="45" font-family="monospace" font-size="11" text-anchor="middle" fill="#2E7D32">input[N]</text>
    </g>
    
    <!-- Input Config -->
    <g transform="translate(15, 370)">
      <rect x="0" y="0" width="250" height="95" rx="6" fill="#E3F2FD" stroke="#1976D2" stroke-width="1"/>
      <text x="125" y="18" font-family="Arial" font-size="11" text-anchor="middle" fill="#1565C0" font-weight="bold">FilterIOSlot Configuration</text>
      <text x="10" y="35" font-family="monospace" font-size="9" fill="#333">uint32_t index;</text>
      <text x="10" y="48" font-family="monospace" font-size="9" fill="#333">Type type; // Image|Buffer|Sampled</text>
      <text x="10" y="61" font-family="monospace" font-size="9" fill="#333">VkFormat format;</text>
      <text x="10" y="74" font-family="monospace" font-size="9" fill="#333">VkImageTiling tiling;</text>
      <text x="10" y="87" font-family="monospace" font-size="9" fill="#333">uint32_t baseBinding; // computed</text>
    </g>
  </g>
  
  <!-- ============ COMPUTE SHADER (CENTER) ============ -->
  <g transform="translate(340, 100)">
    <!-- Shader container -->
    <rect x="0" y="0" width="680" height="480" rx="10" fill="#E3F2FD" stroke="#1976D2" stroke-width="3" filter="url(#shadow)"/>
    <rect x="0" y="0" width="680" height="45" rx="10" fill="url(#shaderGrad)"/>
    <rect x="0" y="35" width="680" height="10" fill="url(#shaderGrad)"/>
    <text x="340" y="30" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="white">
      COMPUTE SHADER PIPELINE
    </text>
    
    <!-- Stage 1: Input Processing -->
    <g transform="translate(20, 60)">
      <rect x="0" y="0" width="200" height="200" rx="8" fill="white" stroke="#4CAF50" stroke-width="2"/>
      <rect x="0" y="0" width="200" height="30" rx="8" fill="#66BB6A"/>
      <rect x="0" y="22" width="200" height="8" fill="#66BB6A"/>
      <text x="100" y="22" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="white">STAGE 1: INPUT</text>
      
      <text x="10" y="50" font-family="Arial" font-size="11" fill="#333" font-weight="bold">fetch()</text>
      <text x="15" y="65" font-family="Arial" font-size="9" fill="#666">Read from image/buffer</text>
      <text x="15" y="78" font-family="Arial" font-size="9" fill="#666">Handle multi-planar layouts</text>
      
      <line x1="10" y1="88" x2="190" y2="88" stroke="#ddd"/>
      
      <text x="10" y="105" font-family="Arial" font-size="11" fill="#333" font-weight="bold">unpack()</text>
      <text x="15" y="120" font-family="Arial" font-size="9" fill="#666">Extract Y, Cb, Cr from packed</text>
      <text x="15" y="133" font-family="Arial" font-size="9" fill="#666">Handle 8/10/12/16-bit</text>
      
      <line x1="10" y1="143" x2="190" y2="143" stroke="#ddd"/>
      
      <text x="10" y="160" font-family="Arial" font-size="11" fill="#333" font-weight="bold">normalize()</text>
      <text x="15" y="175" font-family="Arial" font-size="9" fill="#666">Convert to [0.0, 1.0] range</text>
      <text x="15" y="188" font-family="Arial" font-size="9" fill="#666">Handle limited/full range</text>
    </g>
    
    <!-- Stage 2: Processing -->
    <g transform="translate(240, 60)">
      <rect x="0" y="0" width="200" height="200" rx="8" fill="white" stroke="#1976D2" stroke-width="2"/>
      <rect x="0" y="0" width="200" height="30" rx="8" fill="#42A5F5"/>
      <rect x="0" y="22" width="200" height="8" fill="#42A5F5"/>
      <text x="100" y="22" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="white">STAGE 2: FILTER</text>
      
      <text x="10" y="50" font-family="Arial" font-size="11" fill="#333" font-weight="bold">colorConvert()</text>
      <text x="15" y="65" font-family="Arial" font-size="9" fill="#666">RGB ↔ YCbCr matrix</text>
      <text x="15" y="78" font-family="Arial" font-size="9" fill="#666">BT.601, BT.709, BT.2020</text>
      
      <line x1="10" y1="88" x2="190" y2="88" stroke="#ddd"/>
      
      <text x="10" y="105" font-family="Arial" font-size="11" fill="#333" font-weight="bold">downsample()</text>
      <text x="15" y="120" font-family="Arial" font-size="9" fill="#666">Chroma subsampling</text>
      <text x="15" y="133" font-family="Arial" font-size="9" fill="#666">4:4:4 → 4:2:2 → 4:2:0</text>
      
      <line x1="10" y1="143" x2="190" y2="143" stroke="#ddd"/>
      
      <text x="10" y="160" font-family="Arial" font-size="11" fill="#333" font-weight="bold">filter()</text>
      <text x="15" y="175" font-family="Arial" font-size="9" fill="#666">Custom filtering ops</text>
      <text x="15" y="188" font-family="Arial" font-size="9" fill="#666">All in normalized space</text>
    </g>
    
    <!-- Stage 3: Output Processing -->
    <g transform="translate(460, 60)">
      <rect x="0" y="0" width="200" height="200" rx="8" fill="white" stroke="#FF9800" stroke-width="2"/>
      <rect x="0" y="0" width="200" height="30" rx="8" fill="#FFA726"/>
      <rect x="0" y="22" width="200" height="8" fill="#FFA726"/>
      <text x="100" y="22" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="white">STAGE 3: OUTPUT</text>
      
      <text x="10" y="50" font-family="Arial" font-size="11" fill="#333" font-weight="bold">denormalize()</text>
      <text x="15" y="65" font-family="Arial" font-size="9" fill="#666">Convert from [0.0, 1.0]</text>
      <text x="15" y="78" font-family="Arial" font-size="9" fill="#666">Apply limited/full range</text>
      
      <line x1="10" y1="88" x2="190" y2="88" stroke="#ddd"/>
      
      <text x="10" y="105" font-family="Arial" font-size="11" fill="#333" font-weight="bold">pack()</text>
      <text x="15" y="120" font-family="Arial" font-size="9" fill="#666">Pack to target format</text>
      <text x="15" y="133" font-family="Arial" font-size="9" fill="#666">Handle bit depth/layout</text>
      
      <line x1="10" y1="143" x2="190" y2="143" stroke="#ddd"/>
      
      <text x="10" y="160" font-family="Arial" font-size="11" fill="#333" font-weight="bold">write()</text>
      <text x="15" y="175" font-family="Arial" font-size="9" fill="#666">imageStore() / buffer write</text>
      <text x="15" y="188" font-family="Arial" font-size="9" fill="#666">Write to each output slot</text>
    </g>
    
    <!-- Data flow arrows -->
    <g transform="translate(0, 155)">
      <line x1="220" y1="0" x2="240" y2="0" stroke="#2E7D32" stroke-width="3" marker-end="url(#arrow-green)"/>
      <line x1="440" y1="0" x2="460" y2="0" stroke="#1565C0" stroke-width="3" marker-end="url(#arrow-blue)"/>
    </g>
    
    <!-- Normalized color space indicator -->
    <g transform="translate(130, 275)">
      <rect x="0" y="0" width="420" height="30" rx="5" fill="#FFF9C4" stroke="#FBC02D" stroke-width="1"/>
      <text x="210" y="20" font-family="Arial" font-size="12" text-anchor="middle" fill="#F57F17" font-weight="bold">
        ⚡ All internal processing in normalized [0.0, 1.0] color space ⚡
      </text>
    </g>
    
    <!-- Dispatch handling -->
    <g transform="translate(20, 320)">
      <rect x="0" y="0" width="640" height="145" rx="8" fill="#FFF3E0" stroke="#FF9800" stroke-width="1"/>
      <text x="320" y="22" font-family="Arial" font-size="13" text-anchor="middle" fill="#E65100" font-weight="bold">
        DISPATCH &amp; SUBSAMPLE HANDLING
      </text>
      
      <g transform="translate(20, 35)">
        <rect x="0" y="0" width="190" height="95" rx="5" fill="white" stroke="#81C784"/>
        <text x="95" y="18" font-family="Arial" font-size="11" text-anchor="middle" fill="#2E7D32" font-weight="bold">MatchChroma Mode</text>
        <text x="10" y="38" font-family="Arial" font-size="9" fill="#333">Dispatch matches output chroma</text>
        <text x="10" y="52" font-family="Arial" font-size="9" fill="#333">4:2:0 → half width/height</text>
        <text x="10" y="66" font-family="Arial" font-size="9" fill="#333">4:2:2 → half width</text>
        <text x="10" y="80" font-family="Arial" font-size="9" fill="#333">4:4:4 → full resolution</text>
      </g>
      
      <g transform="translate(225, 35)">
        <rect x="0" y="0" width="190" height="95" rx="5" fill="white" stroke="#F44336"/>
        <text x="95" y="18" font-family="Arial" font-size="11" text-anchor="middle" fill="#C62828" font-weight="bold">Fixed2x2 Mode</text>
        <text x="10" y="38" font-family="Arial" font-size="9" fill="#333">ALWAYS 2x2 subsampled</text>
        <text x="10" y="52" font-family="Arial" font-size="9" fill="#333">For AQ algorithms</text>
        <text x="10" y="66" font-family="Arial" font-size="9" fill="#C62828" font-weight="bold">Bug fix: Handle when</text>
        <text x="10" y="80" font-family="Arial" font-size="9" fill="#C62828" font-weight="bold">dispatch ≠ 2x2</text>
      </g>
      
      <g transform="translate(430, 35)">
        <rect x="0" y="0" width="190" height="95" rx="5" fill="white" stroke="#9E9E9E"/>
        <text x="95" y="18" font-family="Arial" font-size="11" text-anchor="middle" fill="#616161" font-weight="bold">None Mode</text>
        <text x="10" y="38" font-family="Arial" font-size="9" fill="#333">No subsampling</text>
        <text x="10" y="52" font-family="Arial" font-size="9" fill="#333">1:1 with dispatch</text>
        <text x="10" y="66" font-family="Arial" font-size="9" fill="#333">For RGBA outputs</text>
        <text x="10" y="80" font-family="Arial" font-size="9" fill="#333">or Y-only planes</text>
      </g>
    </g>
  </g>
  
  <!-- ============ OUTPUT SIDE ============ -->
  <g transform="translate(1050, 100)">
    <!-- Output container -->
    <rect x="0" y="0" width="320" height="480" rx="10" fill="#FFF3E0" stroke="#FF9800" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="320" height="40" rx="10" fill="url(#outputGrad)"/>
    <rect x="0" y="30" width="320" height="10" fill="url(#outputGrad)"/>
    <text x="160" y="28" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="white">
      OUTPUTS (Dynamic Slots)
    </text>
    
    <!-- Output Slot 0: Encoder -->
    <g transform="translate(15, 55)">
      <rect x="0" y="0" width="290" height="100" rx="6" fill="white" stroke="#FF9800" stroke-width="1.5"/>
      <rect x="0" y="0" width="290" height="25" rx="6" fill="#FFCC80"/>
      <rect x="0" y="20" width="290" height="5" fill="#FFCC80"/>
      <text x="145" y="17" font-family="monospace" font-size="12" text-anchor="middle" fill="#E65100" font-weight="bold">output[0] - Encoder (Optimal)</text>
      
      <text x="10" y="42" font-family="Arial" font-size="10" fill="#333">Format: NV12, P010, I420, YUV444</text>
      <text x="10" y="56" font-family="Arial" font-size="10" fill="#333">Tiling: VK_IMAGE_TILING_OPTIMAL</text>
      <text x="10" y="70" font-family="Arial" font-size="10" fill="#333">Subsample: MatchChroma</text>
      <text x="10" y="85" font-family="Arial" font-size="9" fill="#888">Bindings: N+0 to N+3</text>
    </g>
    
    <!-- Output Slot 1: Dumper -->
    <g transform="translate(15, 165)">
      <rect x="0" y="0" width="290" height="100" rx="6" fill="white" stroke="#FF9800" stroke-width="1.5"/>
      <rect x="0" y="0" width="290" height="25" rx="6" fill="#FFE0B2"/>
      <rect x="0" y="20" width="290" height="5" fill="#FFE0B2"/>
      <text x="145" y="17" font-family="monospace" font-size="12" text-anchor="middle" fill="#E65100" font-weight="bold">output[1] - Dumper (Linear)</text>
      
      <text x="10" y="42" font-family="Arial" font-size="10" fill="#333">Format: Same as output[0]</text>
      <text x="10" y="56" font-family="Arial" font-size="10" fill="#333">Tiling: VK_IMAGE_TILING_LINEAR</text>
      <text x="10" y="70" font-family="Arial" font-size="10" fill="#333">Subsample: MatchChroma</text>
      <text x="10" y="85" font-family="Arial" font-size="9" fill="#888">Bindings: N+4 to N+7</text>
    </g>
    
    <!-- Output Slot 2: AQ Subsampled -->
    <g transform="translate(15, 275)">
      <rect x="0" y="0" width="290" height="100" rx="6" fill="#FFEBEE" stroke="#F44336" stroke-width="2"/>
      <rect x="0" y="0" width="290" height="25" rx="6" fill="#EF9A9A"/>
      <rect x="0" y="20" width="290" height="5" fill="#EF9A9A"/>
      <text x="145" y="17" font-family="monospace" font-size="12" text-anchor="middle" fill="#C62828" font-weight="bold">output[2] - AQ (2x2 Y)</text>
      
      <text x="10" y="42" font-family="Arial" font-size="10" fill="#333">Format: R8_UNORM / R16_UNORM</text>
      <text x="10" y="56" font-family="Arial" font-size="10" fill="#333">isYOnly: true (single plane)</text>
      <text x="10" y="70" font-family="Arial" font-size="10" fill="#C62828" font-weight="bold">Subsample: Fixed2x2 (ALWAYS)</text>
      <text x="10" y="85" font-family="Arial" font-size="9" fill="#888">Bindings: N+8</text>
    </g>
    
    <!-- Output Slot N -->
    <g transform="translate(15, 385)">
      <rect x="0" y="0" width="290" height="80" rx="6" fill="white" stroke="#FFCC80" stroke-width="1.5" stroke-dasharray="5,3"/>
      <text x="145" y="30" font-family="Arial" font-size="14" text-anchor="middle" fill="#666">...</text>
      <text x="145" y="50" font-family="monospace" font-size="11" text-anchor="middle" fill="#E65100">output[M]</text>
      <text x="145" y="70" font-family="Arial" font-size="10" text-anchor="middle" fill="#888">Additional outputs as needed</text>
    </g>
  </g>
  
  <!-- Main arrows -->
  <line x1="310" y1="340" x2="340" y2="340" stroke="#2E7D32" stroke-width="4" marker-end="url(#arrow-green)"/>
  <line x1="1020" y1="340" x2="1050" y2="340" stroke="#E65100" stroke-width="4" marker-end="url(#arrow-orange)"/>
  
  <!-- ============ BINDING LAYOUT (BOTTOM) ============ -->
  <g transform="translate(30, 610)">
    <rect x="0" y="0" width="1340" height="200" rx="10" fill="white" stroke="#9C27B0" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="1340" height="35" rx="10" fill="#CE93D8"/>
    <rect x="0" y="25" width="1340" height="10" fill="#CE93D8"/>
    <text x="670" y="25" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="white">
      DYNAMIC DESCRIPTOR BINDING LAYOUT
    </text>
    
    <!-- Binding visualization -->
    <g transform="translate(20, 50)">
      <!-- Input bindings -->
      <g>
        <text x="0" y="15" font-family="Arial" font-size="11" fill="#2E7D32" font-weight="bold">Inputs:</text>
        <rect x="60" y="0" width="180" height="35" rx="4" fill="#E8F5E9" stroke="#4CAF50"/>
        <text x="150" y="15" font-family="monospace" font-size="10" text-anchor="middle" fill="#333">input[0]: bind 0-3</text>
        <text x="150" y="28" font-family="Arial" font-size="9" text-anchor="middle" fill="#666">RGBA/Y/CbCr/Cr</text>
        
        <rect x="250" y="0" width="180" height="35" rx="4" fill="#E8F5E9" stroke="#81C784" stroke-dasharray="3,2"/>
        <text x="340" y="15" font-family="monospace" font-size="10" text-anchor="middle" fill="#333">input[1]: bind 4-7</text>
        <text x="340" y="28" font-family="Arial" font-size="9" text-anchor="middle" fill="#666">(optional)</text>
      </g>
      
      <!-- Output bindings -->
      <g transform="translate(0, 50)">
        <text x="0" y="15" font-family="Arial" font-size="11" fill="#E65100" font-weight="bold">Outputs:</text>
        <rect x="60" y="0" width="180" height="35" rx="4" fill="#FFF3E0" stroke="#FF9800"/>
        <text x="150" y="15" font-family="monospace" font-size="10" text-anchor="middle" fill="#333">output[0]: bind 8-11</text>
        <text x="150" y="28" font-family="Arial" font-size="9" text-anchor="middle" fill="#666">Encoder optimal</text>
        
        <rect x="250" y="0" width="180" height="35" rx="4" fill="#FFF3E0" stroke="#FF9800"/>
        <text x="340" y="15" font-family="monospace" font-size="10" text-anchor="middle" fill="#333">output[1]: bind 12-15</text>
        <text x="340" y="28" font-family="Arial" font-size="9" text-anchor="middle" fill="#666">Dumper linear</text>
        
        <rect x="440" y="0" width="120" height="35" rx="4" fill="#FFEBEE" stroke="#F44336"/>
        <text x="500" y="15" font-family="monospace" font-size="10" text-anchor="middle" fill="#333">output[2]: bind 16</text>
        <text x="500" y="28" font-family="Arial" font-size="9" text-anchor="middle" fill="#666">2x2 Y (AQ)</text>
      </g>
      
      <!-- Uniform buffer -->
      <g transform="translate(0, 100)">
        <text x="0" y="15" font-family="Arial" font-size="11" fill="#7B1FA2" font-weight="bold">Params:</text>
        <rect x="60" y="0" width="150" height="35" rx="4" fill="#F3E5F5" stroke="#9C27B0"/>
        <text x="135" y="15" font-family="monospace" font-size="10" text-anchor="middle" fill="#333">uniform: bind 17</text>
        <text x="135" y="28" font-family="Arial" font-size="9" text-anchor="middle" fill="#666">PushConstants</text>
      </g>
    </g>
    
    <!-- Shader variable naming -->
    <g transform="translate(620, 50)">
      <rect x="0" y="0" width="700" height="135" rx="6" fill="#ECEFF1" stroke="#607D8B"/>
      <text x="350" y="20" font-family="Arial" font-size="12" text-anchor="middle" fill="#37474F" font-weight="bold">Indexed Shader Variable Naming</text>
      
      <text x="20" y="45" font-family="monospace" font-size="10" fill="#2E7D32">layout(set=0, binding=0) uniform sampler2D input0_rgba;</text>
      <text x="20" y="60" font-family="monospace" font-size="10" fill="#2E7D32">layout(set=0, binding=4) readonly image2DArray input1_Y;</text>
      
      <text x="20" y="80" font-family="monospace" font-size="10" fill="#E65100">layout(set=0, binding=8) writeonly image2DArray output0_Y;</text>
      <text x="20" y="95" font-family="monospace" font-size="10" fill="#E65100">layout(set=0, binding=12) writeonly image2DArray output1_Y;</text>
      <text x="20" y="110" font-family="monospace" font-size="10" fill="#C62828">layout(set=0, binding=16) writeonly image2DArray output2_Y; // 2x2</text>
      
      <text x="20" y="128" font-family="monospace" font-size="10" fill="#7B1FA2">layout(set=0, binding=17) uniform Params { ... } params;</text>
    </g>
  </g>
  
  <!-- Legend -->
  <g transform="translate(30, 835)">
    <rect x="0" y="0" width="1340" height="60" rx="8" fill="#FAFAFA" stroke="#E0E0E0"/>
    <text x="20" y="20" font-family="Arial" font-size="12" fill="#333" font-weight="bold">Legend:</text>
    
    <rect x="80" y="8" width="20" height="15" rx="2" fill="#E8F5E9" stroke="#4CAF50"/>
    <text x="105" y="20" font-family="Arial" font-size="10" fill="#333">Input Slot</text>
    
    <rect x="180" y="8" width="20" height="15" rx="2" fill="#FFF3E0" stroke="#FF9800"/>
    <text x="205" y="20" font-family="Arial" font-size="10" fill="#333">Output Slot</text>
    
    <rect x="290" y="8" width="20" height="15" rx="2" fill="#FFEBEE" stroke="#F44336"/>
    <text x="315" y="20" font-family="Arial" font-size="10" fill="#333">Fixed2x2 (AQ)</text>
    
    <rect x="420" y="8" width="20" height="15" rx="2" fill="#E3F2FD" stroke="#1976D2"/>
    <text x="445" y="20" font-family="Arial" font-size="10" fill="#333">Processing Stage</text>
    
    <rect x="560" y="8" width="20" height="15" rx="2" fill="white" stroke="#888" stroke-dasharray="3,2"/>
    <text x="585" y="20" font-family="Arial" font-size="10" fill="#333">Optional</text>
    
    <text x="680" y="20" font-family="Arial" font-size="10" fill="#666">|</text>
    
    <text x="700" y="20" font-family="Arial" font-size="11" fill="#1565C0" font-weight="bold">Key Principle:</text>
    <text x="800" y="20" font-family="Arial" font-size="10" fill="#333">All internal processing in normalized [0.0, 1.0] space</text>
    
    <text x="20" y="48" font-family="Arial" font-size="10" fill="#C62828" font-weight="bold">⚠️ Critical Fix:</text>
    <text x="120" y="48" font-family="Arial" font-size="10" fill="#333">Fixed2x2 outputs must work regardless of dispatch resolution (4:4:4 outputs need special handling)</text>
  </g>
  
  <!-- Version info -->
  <text x="1370" y="1090" font-family="Arial" font-size="10" text-anchor="end" fill="#999">v2.0 - Flexible I/O Architecture</text>
</svg>
